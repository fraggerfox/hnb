LIBS=-lncurses libcli/libcli.a
CFLAGS=-I.. -Ilibcli -DHAVE_CONFIG_H -Wall -O2

OBJS= ui_cli.o hnb.o node.o path.o prefs.o tokenizer.o tree.o tree_sort.o tree_todo.o\
	ui.o ui_binding.o ui_draw.o ui_overlay.o evilloop.o ui_edit.o \
	ui_style.o tree_misc.o\
	file.o xml_tok.o \
	file_hnb.o file_xml.o file_html.o  file_ascii.o file_help.o file_ps.o\
# 	file_libxml.o file_dot.o file_slides.o \


hnb: libcli/libcli.a $(OBJS) Makefile
	cc -o hnb $(OBJS) $(LIBS)

ui_cli.c: cli_entries.inc cli_decls.inc

xml_debug: xml_tok.o xml_debug.o
	cc -o xml_debug xml_tok.o xml_debug.o

libcli/libcli.a: libcli/*.c
	(cd libcli;make)
libcli/libcli_p.a: libcli/*.c
	(cd libcli;make libcli_p.a)

cli_entries.inc: *.c
	echo "/* this file is autogenerated, do not edit */">cli_entries.inc
	cat *.c |grep "^\!cli "|sed "s/\!cli //">>cli_entries.inc
cli_decls.inc: *.c
	echo "/* this file is autogenerated, do not edit */">cli_decls.inc
	cat *.c |grep "^\!clid "|sed "s/\!clid //">>cli_decls.inc
clean:
	rm -f xml_debug hnb $(OBJS) *~ cli_*.inc
	(cd libcli;make clean)
hnb_p: *.c libcli/libcli_p.a
	cc -o hnb_p *.c -pg -lncurses_p libcli/libcli_p.a -I.. -Ilibcli -DHAVE_CONFIG_H

ps:
	dot -Tps xml.dot > xml_states.ps

